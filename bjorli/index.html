<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="bever.css">
    <title>Bjorlileika</title>
</head>
<body>
    <label for="date-select">Velg dato:</label>
    <select id="date-select" onChange="generateTable()">
        <option value="2024-03" selected>2024-03</option>
        <option value="2022-10">2022-10</option>
        <option value="2022-02">2022-02</option>
        <option value="2021-09">2021-09</option>
    </select>

    <div id="table-container"></div>
    <div class="beaver-container">
      <div class="tail"></div>
      <div class="beaver">
        <div class="ear"></div>
        <div class="eye"></div>
        <div class="nose"></div>
        <div class="tooth"></div>
      </div>
    </div>

    <h1>Weather Data</h1>
    <div id="weather-container">
        <textarea id="weather-textbox" readonly></textarea>
    </div>

    <script type="module">
        import init, { generate_html_table_for_date, get_weather_data} from "./pkg/bjorli.js";
        const latitude = 52.52;
        const longitude = 13.41;

        async function generateTable() {
            await init();
            const date = document.getElementById('date-select').value;
            try {
                const tableHtml = generate_html_table_for_date(date);
                document.getElementById('table-container').innerHTML = tableHtml;
                
                const weatherData = await get_weather_data(latitude, longitude);

                // Dump the raw weather data into the text box
                const textbox = document.getElementById('weather-textbox');
                textbox.value = JSON.stringify(weatherData, null, 2); // Pretty-print with indentation
            } catch (error) {
                document.getElementById('table-container').innerHTML = "Ingen data her gitt!";
            }
        }
        window.generateTable = generateTable;
        document.addEventListener("DOMContentLoaded", generateTable);
    </script>
</body>
</html>
